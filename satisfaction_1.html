<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QA_5</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <label id="satisfaction_q_1"></label><br/><br/>

    <select id="satisfactionDropdown_1">
        <option value="">Select Answer</option>
    </select><br/><br/>

    <button id="submitButton">Submit</button>

    <script>
        $(document).ready(function() {
            // Send AJAX request to fetch questions and answers
            $.ajax({
                url: "http://localhost:5000/satisfaction_q/1",
                method: 'GET',
                dataType: 'json',
                success: function(data) {
                    var satisfactionQ_list = data.satisfactionQ_list;

                    var $satisfaction_q = $('#satisfaction_q_1');

                    $.each(satisfactionQ_list, function(index, satisfactionItem) {
                        $satisfaction_q.append(
                            $('<span></span>').val(satisfactionItem.q_id).text(satisfactionItem.q_text)
                        );
                    });
                }
            });

            $.ajax({
                url: "http://localhost:5000/satisfaction_q/1",
                method: 'GET',
                dataType: 'json',
                success: function(data) {
                    var satisfactionA_list = data.satisfactionA_list[0];

                    var $dropdown = $('#satisfactionDropdown_1');

                    $.each(satisfactionA_list, function(index, satisfactionAItem) {
                        $dropdown.append(
                            $('<option></option>').val(satisfactionAItem.ans_id).text(satisfactionAItem.ans_text)
                        );
                    });
                },
                error: function(xhr, status, error) {
                    console.error("AJAX Error: ", status, error);
                }
            });

            /*$.ajax({
                url: "http://localhost:5000/satisfaction_ans",
                method: 'GET',
                dataType: 'json',
                success: function(data) {
                    var $dropdown = $('#satisfactionDropdown_1');
                    $.each(data, function(index, item) {
                        $dropdown.append(
                            $('<option></option>').val(item.ans_id).text(item.ans_text)
                        );
                    });
                },
                error: function(xhr, status, error) {
                    console.error("AJAX Error: ", status, error);
                }
            });*/
        });

        // Event listener for Submit button
        $('#submitButton').click(function() {
            var q_id = $('#satisfaction_q_1 span').val();
            var ans_id = $('#satisfactionDropdown_1').val(); 

            console.log(q_id);

            $.ajax({
                url: 'http://localhost:5000/satisfaction_transaction',
                method: 'POST',
                dataType: 'json',
                data: {
                    q_id: q_id,
                    ans_id:ans_id,
                },
                success: function(response) {
                    console.log(response);
                    alert('Success');
                },
                error: function(xhr, status, error) {
                    console.error("AJAX Error: ", status, error);
                }
            });

            return false;
        });
    </script>
</body>
</html>